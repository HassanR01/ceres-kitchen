import Cursor from '../components/Cursor'
import Footer from '../components/Footer'
import Header from '../components/Header'
import './globals.css'
import Bgimage from '../../public/bg.png'
import Script from 'next/script'
import { NextAuthProvider } from './providers'


const getAdmins = async () => {
  const apiUrl = process.env.API_URL
  try {
    
    const res = await fetch(`${apiUrl}/api/admins`, {
      cache: "no-store"
    })
    
    if (!res.ok) {
      throw new Error('Faild to Get the Admins')
    }
    return res.json()

  } catch (error) {
    console.log(error);
  }
  
}

export const metadata = {
  title: 'Ceres Kitchen',
  description: 'Generated by Ceres Kitchen',
}

export default async function RootLayout({ children }) {
  const { admin } = await getAdmins()
  return (
    <html lang="en">
      <body suppressHydrationWarning={true} style={{
        backgroundImage: `url(${Bgimage.src})`,
        backgroundSize: 'cover',
        backgroundAttachment: 'fixed',
        backgroundPosition: 'center'
      }}>
        <NextAuthProvider>
          <Header admins={admin} />
          {children}
          <Cursor />
          <Footer />
          <Script src='JS/main.js' />
        </NextAuthProvider>
      </body>
    </html>
  )
}
